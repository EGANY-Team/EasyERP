﻿<div class="form-holder task-create-holder">
    <form method="post" action="" id="editTaskForm" class="form" data-id="<%=model._id%>">
        <fieldset>
            <div class="half-block left withPaddingLeft">
                <a id="projectTopName" href="#easyErp/Projects/form/<%=model.project._id%>"><%=model.project.projectShortDesc%></a>
            </div>
            <div class="half-block left">
                <dl class="person-info-h3 right">
                    <dt><label>Assigned to :</label></dt>
                    <dd>
                        <a id="assignedToDd" data-id="<%=(model.assignedTo) ? model.assignedTo._id : ''%>" class="current-selected" href="javascript:;"><%=model.assignedTo.name.first+' '+model.assignedTo.name.last%></a>
                </dl>
            </div>
            <div class="clearfix">
            </div>
            <input type="text" name="summary" class="input-title-long blueback projectSummary" id="summaryEdit" value="<%=model.summary%>" required maxlength="32" />
            <div class="half-block left withPaddingLeftProject taskNote">
                <div class="">
                    <textarea type="text" name="description" class="taskDescriptionCreate" placeholder="Add a Description" id="description" required><%=model.description%> </textarea>
                </div>
            </div>
            <div class="half-block left withPaddingRightProject">
                <div class="inner">
                    <dl class="task-info">
                        <dt><label>Project </label></dt>
                        <dd>
                            <a id="projectDd" data-shortdesc="<%=model.project.projectShortDesc%>" data-id="<%=model.project._id%>" class="current-selected" href="javascript:;"><%=model.project.projectName%></a>
                        </dd>
                        <dt><label for="workflowNamesDd">Workflow</label></dt>
                        <dd>
                            <a id="workflowNamesDd" data-id="<%=model.workflow.wName%>" class="current-selected" href="javascript:;"><%=model.workflow.wName%></a>

                        </dd>
                        <dt><label for="workflowsDd">Stage </label></dt>
                        <dd>
                            <a id="workflowsDd" data-id="<%=model.workflow._id%>" class="current-selected" href="javascript:;"><%=model.workflow.name%></a>
                        </dd>

                        <dt><label>Type </label></dt>
                        <dd>
                            <a id="type" data-id="<%=model.type%>" class="current-selected" href="javascript:;"><%=model.type%></a>
                            <ul class="newSelectList hidden">
                                <li class="Task" id="Task">Task</li>
                                <li class="Bug" id="Bug">Bug</li>
                                <li class="Feature" id="Feature">Feature</li>
                            </ul>
                        </dd>

                        <!--<dt><label for="deadline">Deadline </label></dt>
                        <dd><input class="blueback" type="text" name="deadline" id="deadline" value="<%= model.deadline %>" readonly maxlength="32" /></dd>-->

                        <dt><label for="priorityDd">Priority </label></dt>
                        <dd>
                            <a id="priorityDd" data-id="<%=model.priority%>" class="current-selected" href="javascript:;"><%=model.priority%></a>
                        </dd>

                        <dt><label for="StartDate">Start Date</label></dt>
                        <dd><input class="extrainfo blueback" type="text" name="StartDate" id="StartDate" value="<%= model.StartDate %>" readonly /></dd>

                        <dt><label for="logged">Logged </label></dt>
                        <dd>
                            <input class="blueback" maxlength="4" type="text" name="logged" id="logged" value="<%=model.logged%>" />
                        </dd>
                        <dt><label for="estimated">Estimated </label></dt>
                        <dd><input class="blueback" type="text" maxlength="4" name="estimated" id="estimated" value="<%=model.estimated%>" /></dd>
                        <div class="clearfix"></div>
                    </dl>

                </div>


                <div class="clearfix"></div>
            </div>
            <div class="clearfix"></div>
            <div class="noteWrapper full-width">
                <label>Note</label>
                <div id="noteBody">
                    <% var n = model.notes.length-1;
                    model.notes.reverse();
                    _.each(model.notes, function(val,key){ %>
                    <div id="<%=val['_id'] %>" class="noteContainer">
                        <div class="noteTitle"><%=val['title'].replace(/</g,"&#60;").replace(/>/g,"&#62;")  %></div>
                        <div class="noteText"><%=val['note'].replace(/</g,"&#60;").replace(/>/g,"&#62;") %></div>
                        <div>
                            <!--<a class="name" href="javascript:;"><%=val["author"] %></a>--><span class="blue"><%=val["author"] %></span><span class="date"><%=val['date'] %></span>
                            <div class="right">
                                <span>
                                    <a href="javascript:;" id="edit_<%=val['_id']%>" data-id="<%=val['_id']%>" class="editDelNote editNote">Edit</a>
                                </span>
                                <span class="sep">|</span>
                                <span>
                                    <a href="javascript:;" id="del_<%=val['_id']%>" data-id="<%=val['_id']%>" class="editDelNote">Del</a>
                                </span>

                            </div>
                        </div>
                    </div>
                    <div class="clearfix"></div>

                    <% }); model.notes.reverse(); %>
                </div>

                <div class="addNote">
                    <div>
                        <label>Note Content</label>
                        <textarea id="noteArea" placeholder="Add a Note..." maxlength="500"></textarea>
                        <a class="addTitle" href="javascript:;">Add a title</a>
                        <div class="title-wrapper">
                            <label>Note Title</label>
                            <input type="text" id="noteTitleArea" value="" maxlength="64">
                        </div>
                        <div class="buttons">
                            <input type="submit" id="addNote" class="btn" value="Save">
                            <a href="javascript:;" id="cancelNote">Cancel</a>
                            <div class="clearfix">
                            </div>
                        </div>
                        <input type="hidden" id="getNoteKey" value="">
                    </div>
                    <div class="clearfix"></div>
                </div>

                <div class="clearfix"></div>
            </div>

            <label>Attachments</label>
            <div id="attachBody">
                <ul class="attachContainer">
                    <% model.attachments.reverse();
                    _.each(model.attachments, function(data,key){ %>
                    <li class="attachFile_<%=data['_id'] %>">
                        <a href="download/<%=data['shortPas']%>"><%=data['name'] %></a> (<%=data['size'] %>&nbsp;Mb) <%=data['uploaderName'] %>  <%=data['uploadDate'] %>
                        <a id="<%=data['_id'] %>" href="javascript:;" class="deleteAttach">Delete</a>
                    </li>
                    <% }); model.attachments.reverse(); %>
                </ul>
            </div>
            <div class="clearfix"></div>
            <div class="input-file">Attach<input type="file" value="Choose File" class="inputAttach" name="attachfile"></div>
            <div class="progress" style="float:left;">
                <div class="bar">
                    <span class="progress_status"></span>
                </div>
            </div>

            <div class="clearfix"></div>
        </fieldset>
    </form>
