﻿<div class="form-holder">
  <form method="post" action="" id="editTaskForm" class="form" data-id="<%=model._id%>">
    <fieldset>
              <div class="half-block left withPaddingLeft">
                 <a id="projectTopName" href="#easyErp/Projects/form/<%=model.project._id%>"><%=model.project.projectShortDesc%></a>
              </div>
            <div class="half-block left">
                <dl class="person-info-h3 right">
                  <dt><label>Assigned to :</label></dt>
                  <dd><select id="assignedToDd"></select></dd>
                </dl>
            </div>
            <div class="clearfix">
            </div>
            <input type="text" name="summary" class="input-title-long blueback" id="summary" value="<%=model.summary%>" required maxlength="32"/>
            <div class="half-block left withPaddingLeft">
              <div class="inner">
                <textarea type="text" name="description" placeholder="Add a Description" id="description" required ><%=model.description%> </textarea>
              </div>
            </div>
            <div class="half-block left">
              <div class="inner">
                <dl class="person-info">
                  <dt><label>Project </label></dt><dd>
                    <select id="projectDd">
                    </select>
                  </dd>
                  <dt><label for="workflowNamesDd">Workflow :</label></dt><dd>
                    <select id="workflowNamesDd">
                    </select>

                  </dd>
                  <dt><label for="workflowsDd">State </label></dt><dd>
                    <select id="workflowsDd">
                    </select>

                  </dd>

                  <dt><label>Type </label></dt><dd>
                    <select id="type">
                      <% ['Task', 'Bug', 'Feature'].forEach(function(option){ %>
                      <option <%= (option == model.type) ? 'selected="selected"' : ''%>><%= option%></option>
                      <% }); %>
                    </select>
                  </dd>

                  <dt><label for="deadline">Deadline </label></dt><dd><input class="blueback" type="text" name="deadline" id="deadline" value="<%= model.deadline %>" readonly maxlength="32"/></dd>

                  <dt><label for="priorityDd">Priority </label></dt><dd>
                    <select id="priorityDd">
                    </select>
                  </dd>

                  <dt><label for="StartDate">Start Date</label></dt><dd><input class="extrainfo blueback" type="text" name="StartDate" id="StartDate" value="<%= model.extrainfo.StartDate %>" readonly /></dd>

                  <dt><label for="logged">Logged </label></dt><dd>
                    <input class="blueback" type="number" min="0" max="1000" name="logged" id="logged" value="<%=model.logged%>"/>
                  </dd>
                  <dt><label for="estimated">Estimated </label></dt><dd><input class="blueback" type="number" min="0" max="1000" name="estimated" id="estimated" value="<%=model.estimated%>"/></dd>
                 	<div class="clearfix"></div>
                </dl>

              </div>


<div class="clearfix"></div>  
</div>
<div class="clearfix"></div>  
<div class="noteWrapper">
  <label>Note</label>
  <div id="noteBody">
    <% var n = model.notes.length-1;
       model.notes.reverse();
       _.each(model.notes, function(val,key){ %>
    <div id="<%=val['_id'] %>" class="noteContainer">
      <div class="noteTitle"><%=val['title'].replace(/</g,"&#60;").replace(/>/g,"&#62;")  %></div>
      <div class="noteText"><%=val['note'].replace(/</g,"&#60;").replace(/>/g,"&#62;") %></div>
      <div>
		<a class="name" href="javascript:;"><%=name.first %></a><span class="date"><%=val['date'] %></span>
        <div class="right">
          <span>
            <a href="javascript:;" id="edit_<%=val['_id']%>" data-id="<%=val['_id']%>" class="editDelNote editNote" >Edit</a>
          </span>
          <span  class="sep" >|</span>
          <span>
            <a href="javascript:;" id="del_<%=val['_id']%>" data-id="<%=val['_id']%>" class="editDelNote">Del</a>
          </span>

        </div>
	  </div>
    </div>
  <div class="clearfix"></div>

    <% }); model.notes.reverse(); %>
  </div>
  
    <div class="addNote">
	<div>
      <label>Note Content</label>
      <textarea id="noteArea" placeholder="Add a Note..." maxlength="500"></textarea>
	  <a class="addTitle" href="javascript:;">Add a title</a>
      <div class="title-wrapper">
		<label>Note Title</label>
		<input type="text" id="noteTitleArea" value="" maxlength="64">
	  </div>
      <div class="buttons">
		<input type="submit" id="addNote" class="btn" value="Save">
		<a href="javascript:;" id="cancelNote">Cancel</a>
        <div class="clearfix">
        </div>
	  </div>
      <input type="hidden" id="getNoteKey" value="">
	</div>
  <div class="clearfix"></div>
</div>

  <div class="clearfix"></div>
</div>

                              <label>Attachments</label>
                      <div id="attachBody">
                        <ul class="attachContainer">
                           <% var n = model.attachments.length-1;
                              model.attachments.reverse();
                            _.each(model.attachments, function(data,key){ %>
		                   <li class="attachFile_<%=data['_id'] %>"><a href = "<%="download/"+data['name'] %>"><%=data['name'] %></a> (<%=data['size'] %>) <%=data['uploaderName'] %>  <%=data['uploadDate'] %>
		                          <a id="<%=data['_id'] %>" href="javascript:;" class="deleteAttach">Delete</a>
		                   </li>
                       <% }); model.attachments.reverse(); %>
                        </ul>
                      </div>
                      <div class="clearfix"></div>
                      <div class="input-file">Attach<input type="file" value="Choose File" class="inputAttach" name="attachfile"></div>
                      <div class="progress" style="float:left;">
                        <div class="bar">
                          <span class="progress_status"></span>
                        </div>
                      </div>
            <div class="clearfix"></div>
    </fieldset>
  </form>
